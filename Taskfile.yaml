version: "3"

dotenv: [".env", ".envrc"]

tasks:
  default:
    silent: true
    cmds:
      - task --list

  lint:
    silent: true
    desc: Run 'golangci-lint'
    cmds:
      - golangci-lint run --fix

  coverage:
    desc: Run tests with coverage report, used in CI.
    cmds:
      - go test -timeout 10s -tags test -race -coverpkg=./... -covermode=atomic -coverprofile=coverage.out ./...
    env:
      TEST_MYSQL: "1"
      TEST_REDIS: "1"
